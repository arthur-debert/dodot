# PowerUps Guide

PowerUps are the action generators in dodot that process matched files and directories
to create deployment actions. Each powerup serves a specific purpose in managing your
dotfiles.

## Available PowerUps

dodot includes several built-in powerups, each with comprehensive documentation in
their respective packages. For detailed end-to-end documentation of each powerup,
including examples, configuration, and best practices, see:

### Core PowerUps

1. **SymlinkPowerUp** (`symlink`)
   - Creates symlinks from dotfiles to target locations
   - See: `pkg/powerups/symlink/doc.go`
   - Use for: Configuration files, dotfiles

2. **InstallScriptPowerUp** (`install_script`)
   - Executes shell scripts for one-time setup
   - See: `pkg/powerups/install/doc.go`
   - Use for: Installing tools, initial setup

3. **BrewPowerUp** (`brew`)
   - Processes Brewfiles to install Homebrew packages
   - See: `pkg/powerups/homebrew/doc.go`
   - Use for: System packages, GUI apps (macOS)

4. **ShellProfilePowerUp** (`shell_profile`)
   - Sources shell scripts into your environment
   - See: `pkg/powerups/shell_profile/doc.go`
   - Use for: Aliases, functions, shell customization

5. **PathPowerUp** (`path`)
   - Adds directories to system PATH
   - See: `pkg/powerups/path/doc.go`
   - Use for: Personal scripts, tools directories

6. **TemplatePowerUp** (`template`)
   - Processes templates with variable substitution
   - See: `pkg/powerups/template/doc.go`
   - Use for: Machine-specific configurations

### Additional PowerUps

7. **ShellAddPathPowerUp** (`shell_add_path`)
   - Alternative PATH management (use `path` instead)
   - See: `pkg/powerups/shell_add_path/doc.go`

## PowerUp Execution Phases

PowerUps run in different phases based on their RunMode:

### Install Phase (`dodot install`)
- **RunModeOnce** powerups execute here
- InstallScriptPowerUp: Runs setup scripts
- BrewPowerUp: Installs packages
- These run before deployment actions

### Deploy Phase (`dodot deploy`)
- **RunModeMany** powerups execute here
- SymlinkPowerUp: Creates configuration symlinks
- PathPowerUp: Updates PATH
- ShellProfilePowerUp: Sets up shell environment
- TemplatePowerUp: Generates files from templates

## Quick Reference

| PowerUp | Run Mode | Purpose | Creates |
|---------|----------|---------|---------|
| symlink | Deploy | Link configs | Symlinks in ~ |
| install_script | Install | Run setup scripts | Whatever scripts create |
| brew | Install | Install packages | System packages |
| shell_profile | Deploy | Shell config | Entries in init.sh |
| path | Deploy | PATH management | PATH exports |
| template | Deploy | File generation | Processed files |

## PowerUp Documentation Structure

Each powerup's doc.go file contains:

1. **Overview**: What the powerup does
2. **When It Runs**: Deploy vs Install mode
3. **Standard Configuration**: Example matcher configs
4. **File Selection Process**: How files are matched
5. **Execution Strategy**: How it works internally
6. **Storage Locations**: Where files are stored
7. **Effects on User Environment**: What changes are made
8. **Options**: Configuration options
9. **Example End-to-End Flow**: Complete usage example
10. **Error Handling**: Common errors and solutions
11. **Best Practices**: Usage recommendations
12. **Comparison**: When to use vs other powerups

## Creating Custom PowerUps

While dodot includes comprehensive built-in powerups, you can create custom ones:

1. Implement the `PowerUp` interface
2. Register with the powerup registry
3. Define the action type and execution
4. Add to your configuration

See `pkg/types/powerup.go` for the interface definition.

## Best Practices

1. **Read the doc.go files**: Each powerup has extensive documentation
2. **Use the right tool**: Each powerup has a specific purpose
3. **Check run modes**: Understand when powerups execute
4. **Test with --dry-run**: Preview changes before applying
5. **Organize by pack**: Group related configurations
6. **Use standard patterns**: Follow naming conventions

## Troubleshooting

- **Not running?** Check matcher configuration and priorities
- **Errors?** Each doc.go lists common error codes
- **Wrong phase?** Verify RunModeOnce vs RunModeMany
- **Conflicts?** Use --force flag when appropriate

For comprehensive details on any powerup, read its doc.go file in the
pkg/powerups/<name>/ directory.