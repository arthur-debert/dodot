DODOT LIVE SYSTEM TEST PLAN V2
==============================

TEST ORGANIZATION PRINCIPLE
---------------------------
Tests are organized in 5 suites progressing from simple to complex:
1. Single handlers (foundation)
2. Multiple handlers, single packs (pack integration)
3. Multiple handlers, multiple packs (cross-pack integration)
4. Single handlers, edge cases (isolated edge cases)
5. Multi packs/handlers edge cases (complex interactions)

SUITE 1: SINGLE POWER-UPS ✓ DONE
-------------------------
Purpose: Validate minimal dodot features + assertion library
Pattern: Each handler gets YES and NO assertion tests

1.1 Symlink Handler ✓ DONE
- Test: symlink deployed successfully ✓ DONE
- Test: symlink NOT deployed (verify absence) ✓ DONE

1.2 Shell Profile Handler ✓ DONE
- Test: profile sourced in init.sh ✓ DONE
- Test: profile NOT sourced (verify absence) ✓ DONE

1.3 Path Handler ✓ DONE
- Test: bin directory deployed and accessible ✓ DONE
- Test: bin directory NOT deployed (verify absence) ✓ DONE

1.4 Install Script Handler ✓ DONE
- Test: install script executed (marker created) ✓ DONE
- Test: install script NOT executed (verify absence) ✓ DONE

1.5 Homebrew Handler ✓ DONE
- Test: Brewfile processed (sentinel exists) ✓ DONE
- Test: Brewfile NOT processed (verify absence) ✓ DONE

1.6 Template Handler ✓ DONE
- Test: template processed and variables expanded ✓ DONE
- Test: template NOT processed (verify absence) ✓ DONE

SUITE 2: MULTIPLE POWER-UPS, SINGLE PACKS ✓ DONE
------------------------------------------
Purpose: Test handler interactions within single packs
Pattern: Various combinations with YES/NO assertions

2.1 Path + Shell Add Path ✓ DONE
- Test: bin directory deployed and added to PATH in init.sh ✓ DONE

2.2 Deploy-type Handlers Combined ✓ DONE
- Test: symlink + shell in one pack (both deployed) ✓ DONE

2.3 Install-type Handlers Combined ✓ DONE
- Test: install + homebrew in one pack (both executed) ✓ DONE

2.4 All Handlers in One Pack ✓ DONE
- Test: pack with all 6 handler types (all work correctly) ✓ DONE

SUITE 3: MULTIPLE POWER-UPS, MULTIPLE PACKS
--------------------------------------------
Purpose: Test cross-pack interactions
Pattern: Multiple packs with various handler combinations

3.1 Simple Multi-pack Deploy
- Test: 3 packs, each with symlinks (all deployed)
- Test: verify pack isolation (changes to one don't affect others)

3.2 Mixed Multi-pack Deploy/Install
- Test: pack A (deploy), pack B (install), pack C (both)
- Test: verify correct command behavior per pack

3.3 Overlapping Shell Profiles
- Test: multiple packs with profile.sh files (all sourced)
- Test: verify init.sh contains all entries

3.4 Multiple Path Deployments
- Test: multiple packs with bin directories
- Test: verify all paths accessible

SUITE 4: SINGLE POWER-UPS, EDGE CASES
--------------------------------------
Purpose: Test edge cases for each handler in isolation

4.1 Symlink Edge Cases
- Test: symlink to missing source file
- Test: symlink when target exists
- Test: symlink with deep directory structure
- Test: symlink with special characters in name

4.2 Shell Profile Edge Cases
- Test: empty profile.sh file
- Test: profile.sh with syntax errors
- Test: profile.sh with special characters

4.3 Path Edge Cases
- Test: empty bin directory
- Test: bin with non-executable files
- Test: bin with subdirectories

4.4 Install Script Edge Cases
- Test: install.sh that fails (exit 1)
- Test: install.sh with long runtime
- Test: install.sh that modifies pack files

4.5 Homebrew Edge Cases
- Test: empty Brewfile
- Test: Brewfile with invalid entries
- Test: Brewfile with comments only

4.6 Template Edge Cases
- Test: template with missing variables
- Test: template with invalid syntax
- Test: nested template references

SUITE 5: MULTI PACKS/POWER-UPS EDGE CASES
------------------------------------------
Purpose: Test complex interactions and conflicts

5.1 File Conflicts
- Test: two packs trying to symlink same target
- Test: template output conflicts with symlink target
- Test: multiple packs with same executable names

5.2 Dependency Order
- Test: pack A depends on pack B installation
- Test: circular dependencies handling
- Test: install order verification

5.3 State Corruption
- Test: partial deployment recovery
- Test: interrupted installation handling
- Test: cleanup after failures

5.4 Permission Issues
- Test: read-only source files
- Test: write-protected target directories
- Test: mixed ownership scenarios

5.5 Large Scale
- Test: 10+ packs with mixed handlers
- Test: performance with many files
- Test: rollback capabilities

CURRENT STATUS vs TARGET
------------------------

Currently Implemented:
- Suite 1: Complete (all 6 handlers with YES and NO tests) ✓ DONE
- Suite 2: Complete (4 multi-handler combination tests) ✓ DONE
- Test framework validation (test-framework scenario) ✓ DONE
- Infrastructure complete (assertions, debug, safety checks) ✓ DONE
- Rich debug output on test failures ✓ DONE

Needed Implementation:
- Suite 3: All tests need implementation (skeleton exists)
- Suite 4: All tests need implementation (skeleton exists)
- Suite 5: All tests need implementation (skeleton exists)

Open Issues:
No open issues currently reported.

Next Steps:
1. Implement Suite 3 (multi-pack scenarios)
2. Implement Suite 4 (edge cases per handler)
3. Implement Suite 5 (complex edge cases)
